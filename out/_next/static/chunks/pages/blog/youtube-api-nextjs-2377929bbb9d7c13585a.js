_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[78],{"P+SL":function(e,a,t){"use strict";var n=t("q1tI"),c=t.n(n),o=t("mf32"),s=t("BMxC"),b=t("pboS"),p=t("Weur"),r=t("w0db"),m=t("sK1y"),j=c.a.createElement;a.a=function(e){var a=e.header,t=e.link,n=e.metric,c=Object(o.b)().colorMode;return j(s.a,{border:"1px solid",borderColor:{light:"gray.200",dark:"gray.700"}[c],borderRadius:8,p:4,minW:"300px"},j(b.a,{href:t,isExternal:!0},j(p.a,{align:"center"},a,j(r.a,{name:"external-link",mx:2}))),j(m.a,{mt:2,fontSize:"3xl",fontWeight:"bold",lineHeight:"short"},n||"-"))}},TIfR:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/youtube-api-nextjs",function(){return t("c+71")}])},"c+71":function(e,a,t){"use strict";t.r(a),t.d(a,"frontMatter",(function(){return j})),t.d(a,"default",(function(){return u}));var n=t("wx14"),c=t("Ff2n"),o=t("q1tI"),s=t.n(o),b=t("7ljp"),p=t("ZDfL"),r=t("ei/E"),m=t("qh8W"),j=(s.a.createElement,{title:"Create a Dashboard with Next.js API Routes - YouTube API",publishedAt:"2020-02-05",summary:"Learn how to use Next.js API routes to integrate with the YouTube API and retrieve statistics about a channel.",image:"/static/images/dashboard.jpg",wordCount:766,readingTime:{text:"4 min read",minutes:3.82,time:229200,words:764},__resourcePath:"blog/youtube-api-nextjs.mdx",__scans:{},layout:"index"}),O={frontMatter:j},l=p.a;function u(e){var a=e.components,t=Object(c.a)(e,["components"]);return Object(b.b)(l,Object(n.a)({},O,t,{components:a,mdxType:"MDXLayout"}),Object(b.b)("blockquote",null,Object(b.b)("p",{parentName:"blockquote"},"In this series, you will learn how to ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/dashboard"}),"create a dashboard")," using Next.js API routes and integrate with third-party APIs.")),Object(b.b)(r.a,{mdxType:"YouTube"}),Object(b.b)("h2",{id:"overview"},"Overview"),Object(b.b)("p",null,Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://youtube.com"}),"YouTube")," has cemented itself as the number one video sharing platform. Its vibrant community of creators is growing exponentially."),Object(b.b)("p",null,"Tracking metrics about your channel is an integral part of measuring your success.\nYouTube provides ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://developers.google.com/youtube/v3/docs"}),"a Data API"),", which allows you to integrate the platform directly into your website.\nSince I'm a ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.youtube.com/channel/UCZMli3czZnd1uoc1ShTouQw"}),"YouTube Creator"),", I wanted to see how many times my subscriber count and views directly on my site."),Object(b.b)("h2",{id:"getting-access-to-youtube"},"Getting Access to Youtube"),Object(b.b)("p",null,"To gain access to the YouTube API, you need to:"),Object(b.b)("ul",null,Object(b.b)("li",{parentName:"ul"},"Go to the ",Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://console.developers.google.com/"}),"Google Developer Console.")),Object(b.b)("li",{parentName:"ul"},"Create a new project."),Object(b.b)("li",{parentName:"ul"},"Credentials -> Create Credentials -> Service-account key."),Object(b.b)("li",{parentName:"ul"},"Click \u201cEnable APIs and services.\u201d"),Object(b.b)("li",{parentName:"ul"},'Find "YouTube Data API v3" and enable it.')),Object(b.b)("p",null,"Since we're communicating server-to-server, we'll need a ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://developers.google.com/identity/protocols/OAuth2ServiceAccount"}),"service account"),"."),Object(b.b)("ul",null,Object(b.b)("li",{parentName:"ul"},"Go to your ",Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://console.developers.google.com/iam-admin/serviceaccounts"}),"service accounts")," page."),Object(b.b)("li",{parentName:"ul"},"Create a service account."),Object(b.b)("li",{parentName:"ul"},'Click "Create Key" and choose JSON.')),Object(b.b)("p",null,"You should now have a JSON file similar to this:"),Object(b.b)("pre",{className:"language-json"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-json"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"type"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"service_account"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"project_id"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"..."'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"private_key_id"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"..."'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"private_key"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"..."'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"client_email"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"..."'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"client_id"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"..."'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"auth_uri"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"https://accounts.google.com/o/oauth2/auth"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"token_uri"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"https://accounts.google.com/o/oauth2/token"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"auth_provider_x509_cert_url"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"https://www.googleapis.com/oauth2/v1/certs"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"client_x509_cert_url"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"..."'),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(b.b)("p",null,"We use this key later to set up our client in our API Route.\nOkay, back to the ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://console.developers.google.com/iam-admin/serviceaccounts"}),"service account"),".\nWe need to delegate ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://developers.google.com/identity/protocols/OAuth2ServiceAccount#delegatingauthority"}),"domain-wide authority"),"."),Object(b.b)("ul",null,Object(b.b)("li",{parentName:"ul"},"On the table row, click Actions -> Edit."),Object(b.b)("li",{parentName:"ul"},"Show Domain-Wide Delegation -> Enable G-Suite Domain-Wide Delegation.")),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"That's it!")," \ud83c\udf89 You now have access to make requests to the YouTube API with your service account."),Object(b.b)("h2",{id:"creating-an-environment-variable"},"Creating an Environment Variable"),Object(b.b)("p",null,"To securely access the API, we need to include the secret with each request.\nWe also ",Object(b.b)("em",{parentName:"p"},"do not")," want to commit secrets to git. Thus, we should use an environment variable."),Object(b.b)("p",null,"Since I'm deploying with ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://vercel.com"}),"Vercel"),", I can add the secrets via their CLI.\nWe only need a few of the values from the JSON file. For the private key, make sure you convert\nthe new line characters (",Object(b.b)("inlineCode",{parentName:"p"},"\\n"),") to actual new lines."),Object(b.b)("pre",{className:"language-bash"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"$ vc secret ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"add")," -- google-private-key ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"-----BEGIN PRIVATE KEY-----\nMIIEvQIBA\n..\n..\n2DAVOW4c=\n-----END PRIVATE KEY-----"'),"\n$ vc secret ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"add")," google-client-email my-account@project.iam.gserviceaccount.com\n$ vc secret ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"add")," google-client-id ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"721877721877"),"\n")),Object(b.b)("p",null,"To reference these values locally when using ",Object(b.b)("inlineCode",{parentName:"p"},"vc dev"),", they need to be added to your ",Object(b.b)("inlineCode",{parentName:"p"},".env")," file."),Object(b.b)("pre",{className:"language-bash"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token assign-left variable"}),"GOOGLE_PRIVATE_KEY"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"-----BEGIN PRIVATE KEY-----',Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token entity",title:"\\n"}),"\\n"),"DVOW4c=",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token entity",title:"\\n"}),"\\n"),"-----END PRIVATE KEY-----",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token entity",title:"\\n"}),"\\n"),'"'),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token assign-left variable"}),"GOOGLE_CLIENT_EMAIL"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),"my-account@project.iam.gserviceaccount.com\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token assign-left variable"}),"GOOGLE_CLIENT_ID"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"721877721877"),"\n")),Object(b.b)("p",null,"Finally, we need to add the secrets to our ",Object(b.b)("inlineCode",{parentName:"p"},"vercel.json"),"."),Object(b.b)("div",{className:"remark-code-title"},"vercel.json"),Object(b.b)("pre",{className:"language-json"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-json"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"env"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"GOOGLE_PRIVATE_KEY"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"@google-private-key"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"GOOGLE_CLIENT_EMAIL"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"@google-client-email"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"GOOGLE_CLIENT_ID"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"@google-client-id"'),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(b.b)("p",null,"We can now reference the secrets via ",Object(b.b)("inlineCode",{parentName:"p"},"process.env.GOOGLE_PRIVATE_KEY")," in our API route."),Object(b.b)("p",null,Object(b.b)("em",{parentName:"p"},"Note"),": If you have a lot of environment variables in Vercel, you might need to ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/blog/vercel-env-variables-size-limit"}),"encrpyt your service account"),"."),Object(b.b)("h2",{id:"creating-the-api-route"},"Creating the API Route"),Object(b.b)("p",null,"Let's start by creating a new API route at ",Object(b.b)("inlineCode",{parentName:"p"},"pages/api/youtube.js"),"."),Object(b.b)("pre",{className:"language-js"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"export")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"default")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token parameter"}),"req",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),",")," res"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token arrow operator"}),"=>")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"return")," res",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"status"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"200"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"json"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n")),Object(b.b)("p",null,"To make server-side requests to YouTube, we can install the ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/googleapis/google-api-nodejs-client"}),"googleapis")," library."),Object(b.b)("pre",{className:"language-bash"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"$ ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"yarn")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"add")," googleapis\n")),Object(b.b)("p",null,"Then, we can initialize ",Object(b.b)("inlineCode",{parentName:"p"},"googleapis")," inside our API route."),Object(b.b)("pre",{className:"language-js"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"import")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{")," google ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"from")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'googleapis'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"let")," googleAuth",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"export")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"default")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"async")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token parameter"}),"_",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),",")," res"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token arrow operator"}),"=>")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  googleAuth ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"new")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token class-name"}),"google",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"."),"auth",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"."),"GoogleAuth"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    credentials",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      client_email",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," process",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"env"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"GOOGLE_CLIENT_EMAIL"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n      client_id",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," process",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"env"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"GOOGLE_CLIENT_ID"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n      private_key",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," process",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"env"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"GOOGLE_PRIVATE_KEY"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    scopes",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'https://www.googleapis.com/auth/youtube.readonly'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"const")," youtube ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," google",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"youtube"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    auth",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," googleAuth",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    version",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'v3'"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"return")," res",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"status"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"200"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"json"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n")),Object(b.b)("p",null,"Finally, we want to pull statistics for a given channel and return the total number of subscribers and views."),Object(b.b)("pre",{className:"language-js"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"import")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{")," google ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"from")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'googleapis'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"let")," googleAuth",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"export")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"default")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"async")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token parameter"}),"_",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),",")," res"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token arrow operator"}),"=>")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  googleAuth ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"new")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token class-name"}),"google",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"."),"auth",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"."),"GoogleAuth"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    credentials",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      client_email",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," process",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"env"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"GOOGLE_CLIENT_EMAIL"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n      client_id",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," process",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"env"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"GOOGLE_CLIENT_ID"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n      private_key",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," process",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"env"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"GOOGLE_PRIVATE_KEY"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    scopes",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'https://www.googleapis.com/auth/youtube.readonly'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"const")," youtube ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," google",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"youtube"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    auth",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," googleAuth",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    version",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'v3'"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"const")," response ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"await")," youtube",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"channels"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"list"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    id",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'UCZMli3czZnd1uoc1ShTouQw'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    part",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'statistics'"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"const")," channel ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," response",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"data"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"items"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"0"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"const")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{")," subscriberCount",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," viewCount ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," channel",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"statistics"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"return")," res",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"status"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"200"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"json"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    subscriberCount",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    viewCount\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n")),Object(b.b)("h2",{id:"example"},"Example"),Object(b.b)("p",null,"The two cards below talk to ",Object(b.b)("inlineCode",{parentName:"p"},"/api/youtube")," and pull back stats about my YouTube account."),Object(b.b)("p",null,Object(b.b)("em",{parentName:"p"},"Bonus"),": You can cache the API route with the ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control"}),"cache-control")," header."),Object(b.b)("pre",{className:"language-bash"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"Cache-Control: public, max-age",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"120"),", stale-while-revalidate",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"60"),"\n")),Object(b.b)(r.a,{mdxType:"YouTube"}),Object(b.b)("h2",{id:"keep-reading"},"Keep Reading"),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"Create a Dashboard with Next.js API Routes")),Object(b.b)("ul",null,Object(b.b)("li",{parentName:"ul"},"Part 1 - ",Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"/blog/unsplash-api-nextjs"}),"Unsplash API")),Object(b.b)("li",{parentName:"ul"},"Part 2 - ",Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"/blog/youtube-api-nextjs"}),"YouTube API")),Object(b.b)("li",{parentName:"ul"},"Part 3 - ",Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"/blog/google-analytics-api-nextjs"}),"Google Analytics API")),Object(b.b)("li",{parentName:"ul"},"Part 4 - ",Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"/blog/fetching-data-with-swr"}),"Fetching Data with SWR"))),Object(b.b)(m.a,{title:"React 2025",description:"Build and deploy a modern Jamstack application using the most popular open-source software.",href:"https://react2025.com/",icon:"react2025",mdxType:"ProjectCard"}),Object(b.b)(m.a,{title:"jamstackfns",description:"The best serverless functions for JAMstack applications. Deploy to Vercel or Netlify for your static site.",href:"https://jamstackfns.com/",icon:"jamstackfns",mdxType:"ProjectCard"}))}u.isMDXComponent=!0},"ei/E":function(e,a,t){"use strict";var n=t("q1tI"),c=t.n(n),o=t("VtrM"),s=t("6WYK"),b=t.n(s),p=t("hoFu"),r=t("QtGK"),m=t("P+SL"),j=c.a.createElement;a.a=function(){var e=Object(o.a)("/api/youtube",r.a).data,a=b()(null===e||void 0===e?void 0:e.subscriberCount),t=b()(null===e||void 0===e?void 0:e.viewCount),n="https://www.youtube.com/channel/UCZMli3czZnd1uoc1ShTouQw";return j(p.a,{columns:[1,1,2],spacing:4,mb:4},j(m.a,{header:"YouTube Subscribers",link:n,metric:a}),j(m.a,{header:"YouTube Views",link:n,metric:t}))}},hoFu:function(e,a,t){"use strict";var n=t("pVnL"),c=t.n(n),o=t("8OQS"),s=t.n(o),b=t("q1tI"),p=t.n(b),r=t("BMxC"),m=Object(b.forwardRef)((function(e,a){var t=e.gap,n=e.rowGap,o=e.columnGap,b=e.autoFlow,m=e.autoRows,j=e.autoColumns,O=e.templateRows,l=e.templateColumns,u=e.templateAreas,N=e.area,i=e.column,d=e.row,k=s()(e,["gap","rowGap","columnGap","autoFlow","autoRows","autoColumns","templateRows","templateColumns","templateAreas","area","column","row"]);return p.a.createElement(r.a,c()({ref:a,display:"grid",gridArea:N,gridTemplateAreas:u,gridGap:t,gridRowGap:n,gridColumnGap:o,gridAutoColumns:j,gridColumn:i,gridRow:d,gridAutoFlow:b,gridAutoRows:m,gridTemplateRows:O,gridTemplateColumns:l},k))}));m.displayName="Grid";var j=m,O=function(e){return"number"===typeof e?e+"px":e},l=Object(b.forwardRef)((function(e,a){var t=e.columns,n=e.spacingX,o=e.spacingY,b=e.spacing,r=e.minChildWidth,m=s()(e,["columns","spacingX","spacingY","spacing","minChildWidth"]),l=r?function e(a){if(Array.isArray(a))return a.map(e);if(null!==a&&"object"===typeof a&&Object.keys(a).length>0){var t={};for(var n in a)t[n]="repeat(auto-fit, minmax("+O(a[n])+", 1fr))";return t}return null!=a?"repeat(auto-fit, minmax("+O(a)+", 1fr))":null}(r):function e(a){if(Array.isArray(a))return a.map(e);if(null!==a&&"object"===typeof a&&Object.keys(a).length>0){var t={};for(var n in a)t[n]="repeat("+a[n]+", 1fr)";return t}return null!=a?"repeat("+a+", 1fr)":null}(t);return p.a.createElement(j,c()({ref:a,gap:b,columnGap:n,rowGap:o,templateColumns:l},m))}));l.displayName="SimpleGrid";a.a=l},qh8W:function(e,a,t){"use strict";var n=t("q1tI"),c=t.n(n),o=t("hyUy"),s=t("mf32"),b=t("pboS"),p=t("Weur"),r=t("w0db"),m=t("Yn+B"),j=t("qWyU"),O=t("sK1y"),l=c.a.createElement;a.a=function(e){var a=e.title,t=e.description,n=e.href,c=e.icon,u=Object(s.b)().colorMode;return l(b.a,{mb:4,href:n,onClick:function(){return function(e){o.b({"React 2025":"5WGDOKV0","Mastering Next.js":"HV9HDL0O",jamstackfns:"LRXBPLZS"}[e],0)}(a)},title:a,isExternal:!0,_hover:{boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)",textDecoration:"none"}},l(p.a,{align:"center",border:"1px solid",borderColor:{light:"gray.200",dark:"gray.600"}[u],borderRadius:4,p:4},l(r.a,{"aria-label":"LinkedIn",name:c,color:{light:"gray.1000",dark:"white"}[u],size:"32px",ml:2,mr:4}),l(m.a,null,l(j.a,{as:"h4",size:"md",fontWeight:"bold",mb:4,letterSpacing:"tighter"},a),l(O.a,{lineHeight:"1.3"},t))))}}},[["TIfR",1,2,0,3,4,5,6,7,8]]]);
_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[27],{KuUT:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/configuring-sentry-for-nextjs-apps",function(){return t("egaC")}])},egaC:function(e,a,t){"use strict";t.r(a),t.d(a,"frontMatter",(function(){return r})),t.d(a,"default",(function(){return N}));var n=t("wx14"),c=t("Ff2n"),s=t("q1tI"),o=t.n(s),b=t("7ljp"),p=t("ZDfL"),r=(o.a.createElement,{title:"Configuring Sentry for Next.js Apps",publishedAt:"2019-04-23",summary:"Learn how to set up Sentry to capture client-side and server-side exceptions for Next.js applications.",image:"/static/images/configuring-sentry-for-nextjs-apps/banner.png",wordCount:963,readingTime:{text:"5 min read",minutes:4.805,time:288299.99999999994,words:961},__resourcePath:"blog/configuring-sentry-for-nextjs-apps.mdx",__scans:{},layout:"index"}),m={frontMatter:r},j=p.a;function N(e){var a=e.components,t=Object(c.a)(e,["components"]);return Object(b.b)(j,Object(n.a)({},m,t,{components:a,mdxType:"MDXLayout"}),Object(b.b)("blockquote",null,Object(b.b)("p",{parentName:"blockquote"},Object(b.b)("strong",{parentName:"p"},"Update (2020):")," This guide has been updated with the latest Sentry example.")),Object(b.b)("p",null,"For many teams using Next.js, setting up exception monitoring is a critical requirement before going to production.\nThis guide will show you how to use ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://sentry.io"}),"Sentry")," to catch & report errors on both client and server-side."),Object(b.b)("h2",{id:"brief-nextjs-overview"},"Brief Next.JS Overview"),Object(b.b)("p",null,"Next.js gives you a ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://vercel.com/blog/nextjs-server-side-rendering-vs-static-generation"}),"hybrid approach")," for rendering your application.\nYou can choose on a per-page basis whether you want client-side rendering, server-side rendering, or static-site generation."),Object(b.b)("p",null,"Next.js uses ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://nextjs.org/docs/routing/introduction"}),"file system based routing"),".\nAll files inside the ",Object(b.b)("inlineCode",{parentName:"p"},"/pages")," directory will be routed based on their filename (e.g. ",Object(b.b)("inlineCode",{parentName:"p"},"/pages/home.js")," routes to ",Object(b.b)("inlineCode",{parentName:"p"},"your-domain.com/home"),")."),Object(b.b)("p",null,"There are a few Next-specific files you should understand:"),Object(b.b)("ul",null,Object(b.b)("li",{parentName:"ul"},Object(b.b)("inlineCode",{parentName:"li"},"_app.js")," is used to initialize pages and renders on both the client and the server."),Object(b.b)("li",{parentName:"ul"},Object(b.b)("inlineCode",{parentName:"li"},"_error.js")," is rendered by Next.js while handling exceptions."),Object(b.b)("li",{parentName:"ul"},Object(b.b)("inlineCode",{parentName:"li"},"next.config.js")," allows you to override the default configuration.")),Object(b.b)("h2",{id:"implementing-sentry"},"Implementing Sentry"),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"Note:")," You can view the completed example ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vercel/next.js/tree/canary/examples/with-sentry"}),"here"),"."),Object(b.b)("ol",null,Object(b.b)("li",{parentName:"ol"},"Set up an account with ",Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://sentry.io"}),"Sentry")," and retrieve your DSN from your project settings."),Object(b.b)("li",{parentName:"ol"},"Add the required environment variables.")),Object(b.b)("div",{className:"remark-code-title"},".env.local"),Object(b.b)("pre",{className:"language-bash"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token assign-left variable"}),"NEXT_PUBLIC_SENTRY_DSN"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),"\n\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"# Only required to upload sourcemaps"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token assign-left variable"}),"SENTRY_ORG"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token assign-left variable"}),"SENTRY_PROJECT"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token assign-left variable"}),"SENTRY_AUTH_TOKEN"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),"\n")),Object(b.b)("ol",{start:3},Object(b.b)("li",{parentName:"ol"},"Add the required dependencies. Here's an example ",Object(b.b)("inlineCode",{parentName:"li"},"package.json"),". Ensure you have ",Object(b.b)("inlineCode",{parentName:"li"},"v0.0.4-canary.1")," of ",Object(b.b)("inlineCode",{parentName:"li"},"@zeit/next-source-maps")," until a ",Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vercel/next-plugins/issues/634"}),"new version is published"),".")),Object(b.b)("div",{className:"remark-code-title"},"package.json"),Object(b.b)("pre",{className:"language-json"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-json"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"name"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"with-sentry"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"version"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"1.0.0"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"license"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"ISC"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"scripts"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"dev"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"next"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"build"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"next build"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"start"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"next start"'),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"dependencies"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"@sentry/browser"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"^5.15.5"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"@sentry/node"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"^5.15.5"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"@sentry/webpack-plugin"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"^1.11.1"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"@zeit/next-source-maps"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"0.0.4-canary.1"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"next"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"latest"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"react"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"^16.8.6"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"react-dom"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"^16.8.6"'),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(b.b)("ol",{start:4},Object(b.b)("li",{parentName:"ol"},"Override ",Object(b.b)("inlineCode",{parentName:"li"},"_app.js")," to initialize Sentry. Note that it's only enabled when building for production.")),Object(b.b)("div",{className:"remark-code-title"},"pages/_app.js"),Object(b.b)("pre",{className:"language-jsx"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-jsx"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"import")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"*")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"as")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"Sentry")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"from")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'@sentry/node'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"if")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"process",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"env"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"NEXT_PUBLIC_SENTRY_DSN"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"Sentry"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"init"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    enabled",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," process",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"env"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"NODE_ENV")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"===")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'production'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    dsn",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," process",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"env"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"NEXT_PUBLIC_SENTRY_DSN"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"export")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"default")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"function")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token maybe-class-name"}),"App")),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token parameter"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{")," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token maybe-class-name"}),"Component"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),",")," pageProps",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),",")," err ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}")),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// Workaround for https://github.com/vercel/next.js/issues/8592"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"return")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"<"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token class-name"}),"Component"))," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token spread"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"..."),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token attr-value"}),"pageProps"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}"))," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token attr-name"}),"err"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token script language-javascript"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token script-punctuation punctuation"}),"="),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{"),"err",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}"))," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"/>")),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(b.b)("ol",{start:5},Object(b.b)("li",{parentName:"ol"},"Override ",Object(b.b)("inlineCode",{parentName:"li"},"_error.js")," to handle uncaught exceptions.")),Object(b.b)("div",{className:"remark-code-title"},"pages/_error.js"),Object(b.b)("pre",{className:"language-jsx"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-jsx"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"import")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"NextErrorComponent")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"from")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'next/error'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"import")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"*")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"as")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"Sentry")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"from")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'@sentry/node'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"const")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function-variable function"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token maybe-class-name"}),"Error"))," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token parameter"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{")," statusCode",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),",")," hasGetInitialPropsRun",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),",")," err ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}")),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token arrow operator"}),"=>")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"if")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"!"),"hasGetInitialPropsRun ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"&&")," err",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// getInitialProps is not called in case of"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// https://github.com/vercel/next.js/issues/8592. As a workaround, we pass"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// err via _app.js so it can be captured"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"Sentry"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"captureException"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"err",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"return")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"<"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token class-name"}),"NextErrorComponent"))," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token attr-name"}),"statusCode"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token script language-javascript"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token script-punctuation punctuation"}),"="),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{"),"statusCode",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}"))," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"/>")),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token known-class-name class-name"}),"Error"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method-variable function-variable method function property-access"}),"getInitialProps")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"async")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token parameter"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{")," res",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),",")," err",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),",")," asPath ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}")),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token arrow operator"}),"=>")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"const")," errorInitialProps ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"await")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"NextErrorComponent"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"getInitialProps"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    res",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    err\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// Workaround for https://github.com/vercel/next.js/issues/8592, mark when"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// getInitialProps has run"),"\n  errorInitialProps",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"hasGetInitialPropsRun")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"true"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// Running on the server, the response object (`res`) is available."),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"//"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// Next.js will pass an err on the server if a page's data fetching methods"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// threw or returned a Promise that rejected"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"//"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// Running on the client (browser), Next.js will provide an err if:"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"//"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"//  - a page's `getInitialProps` threw or returned a Promise that rejected"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"//  - an exception was thrown somewhere in the React lifecycle (render,"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"//    componentDidMount, etc) that was caught by Next.js's React Error"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"//    Boundary. Read more about what types of exceptions are caught by Error"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"//    Boundaries: https://reactjs.org/docs/error-boundaries.html"),"\n\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"if")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"res",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"?"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"statusCode")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"===")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"404"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// Opinionated: do not record an exception in Sentry for 404"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"return")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{")," statusCode",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"404")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"if")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"err",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"Sentry"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"captureException"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"err",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"await")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"Sentry"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"flush"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"2000"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"return")," errorInitialProps",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// If this point is reached, getInitialProps was called without any"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// information about what the error might be. This is unexpected and may"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// indicate a bug introduced in Next.js, so record it in Sentry"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"Sentry"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"captureException"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"new")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token class-name"}),"Error"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token template-string"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token template-punctuation string"}),"`"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token string"}),"_error.js getInitialProps missing data at path: "),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token interpolation"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token interpolation-punctuation punctuation"}),"${"),"asPath",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token interpolation-punctuation punctuation"}),"}")),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token template-punctuation string"}),"`")),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"await")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"Sentry"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"flush"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"2000"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"return")," errorInitialProps",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"export")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"default")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token known-class-name class-name"}),"Error"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n")),Object(b.b)("ol",{start:6},Object(b.b)("li",{parentName:"ol"},"Override ",Object(b.b)("inlineCode",{parentName:"li"},"next.config.js")," to produce source maps. This enables source maps in production for Sentry and swaps out ",Object(b.b)("inlineCode",{parentName:"li"},"@sentry/node")," for ",Object(b.b)("inlineCode",{parentName:"li"},"@sentry/browser")," when building the client side.")),Object(b.b)("div",{className:"remark-code-title"},"next.config.js"),Object(b.b)("pre",{className:"language-js"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// Use the hidden-source-map option when you don't want the source maps to be"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// publicly available on the servers, only to the error reporting"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"const")," withSourceMaps ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"require"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'@zeit/next-source-maps'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// Use the SentryWebpack plugin to upload the source maps during build step"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"const")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"SentryWebpackPlugin")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"require"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'@sentry/webpack-plugin'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"const")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"NEXT_PUBLIC_SENTRY_DSN"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"SENTRY_DSN"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"SENTRY_ORG"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"SENTRY_PROJECT"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"SENTRY_AUTH_TOKEN"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"NODE_ENV"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"VERCEL_GITHUB_COMMIT_SHA"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"VERCEL_GITLAB_COMMIT_SHA"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"VERCEL_BITBUCKET_COMMIT_SHA"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," process",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"env"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"const")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"COMMIT_SHA")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"VERCEL_GITHUB_COMMIT_SHA")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"||"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"VERCEL_GITLAB_COMMIT_SHA")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"||"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"VERCEL_BITBUCKET_COMMIT_SHA"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\nprocess",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"env"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"SENTRY_DSN")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"SENTRY_DSN"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\nmodule",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"exports")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"withSourceMaps"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function-variable function"}),"webpack"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token parameter"}),"config",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),",")," options"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token arrow operator"}),"=>")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// In `pages/_app.js`, Sentry is imported from @sentry/browser. While"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// @sentry/node will run in a Node.js environment. @sentry/node will use"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// Node.js-only APIs to catch even more unhandled exceptions."),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"//"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// This works well when Next.js is SSRing your page on a server with"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// Node.js, but it is not what we want when your client-side bundle is being"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// executed by a browser."),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"//"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// Luckily, Next.js will call this webpack function twice, once for the"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// server and once for the client. Read more:"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// https://nextjs.org/docs/api-reference/next.config.js/custom-webpack-config"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"//"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// So ask Webpack to replace @sentry/node imports with @sentry/browser when"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// building the browser's bundle"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"if")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"!"),"options",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"isServer"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      config",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"resolve"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"alias"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'@sentry/node'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'@sentry/browser'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// When all the Sentry configuration env variables are available/configured"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// The Sentry webpack plugin gets pushed to the webpack plugins to build"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// and upload the source maps to sentry."),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// This is an alternative to manually uploading the source maps"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// Note: This is disabled in development mode."),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"if")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"\n      ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"SENTRY_DSN")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"&&"),"\n      ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"SENTRY_ORG")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"&&"),"\n      ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"SENTRY_PROJECT")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"&&"),"\n      ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"SENTRY_AUTH_TOKEN")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"&&"),"\n      ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"COMMIT_SHA")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"&&"),"\n      ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"NODE_ENV")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"===")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'production'"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      config",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"plugins"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"push"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"\n        ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"new")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token class-name"}),"SentryWebpackPlugin"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n          include",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'.next'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n          ignore",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'node_modules'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n          urlPrefix",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'~/_next'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n          release",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token constant"}),"COMMIT_SHA"),"\n        ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),"\n      ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"return")," config",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n")),Object(b.b)("h2",{id:"other-notes"},"Other Notes"),Object(b.b)("ul",null,Object(b.b)("li",{parentName:"ul"},"You'll want to upload source maps for the most helpful errors. If you use Vercel, you can add the ",Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://docs.sentry.io/workflow/integrations/vercel"}),"Sentry Integration"),". Otherwise, follow ",Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vercel/next.js/tree/canary/examples/with-sentry#without-using-vercel"}),"these steps"),"."),Object(b.b)("li",{parentName:"ul"},"Source maps and error tracking are ",Object(b.b)("strong",{parentName:"li"},"not enabled")," in development mode."),Object(b.b)("li",{parentName:"ul"},"Both ",Object(b.b)("inlineCode",{parentName:"li"},"@zeit/next-source-maps")," and ",Object(b.b)("inlineCode",{parentName:"li"},"@sentry/webpack-plugin")," are added to ",Object(b.b)("inlineCode",{parentName:"li"},"dependencies")," (rather than ",Object(b.b)("inlineCode",{parentName:"li"},"devDependencies"),") because if used with SSR, these plugins are used during production for generating the source-maps and sending them to Sentry.")))}N.isMDXComponent=!0}},[["KuUT",1,2,0,3,4,5,6,7,8]]]);
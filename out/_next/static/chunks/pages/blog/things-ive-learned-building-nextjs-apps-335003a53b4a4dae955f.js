_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[70],{GeLz:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/things-ive-learned-building-nextjs-apps",function(){return t("kQ/x")}])},"kQ/x":function(e,a,t){"use strict";t.r(a),t.d(a,"frontMatter",(function(){return m})),t.d(a,"default",(function(){return l}));var n=t("wx14"),c=t("Ff2n"),s=t("q1tI"),o=t.n(s),b=t("7ljp"),p=t("ZDfL"),m=(o.a.createElement,{title:"Things I've Learned Building Next.js Apps",publishedAt:"2019-02-15",summary:"CSS-in-JS, Font Loading, Polyfills, Dynamic Imports, MDX, and more!",image:"/static/images/things-ive-learned-building-nextjs-apps/banner.jpg",wordCount:1061,readingTime:{text:"6 min read",minutes:5.295,time:317700,words:1059},__resourcePath:"blog/things-ive-learned-building-nextjs-apps.mdx",__scans:{},layout:"index"}),r={frontMatter:m},j=p.a;function l(e){var a=e.components,t=Object(c.a)(e,["components"]);return Object(b.b)(j,Object(n.a)({},r,t,{components:a,mdxType:"MDXLayout"}),Object(b.b)("p",null,Object(b.b)("img",Object(n.a)({parentName:"p"},{src:"/static/images/things-ive-learned-building-nextjs-apps/nextjs.png",alt:"Next.js"}))),Object(b.b)("p",null,"I've spent a lot of time in the past 4 months creating ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://nextjs.org/"}),"Next.js")," apps for both work and personal use."),Object(b.b)("ul",null,Object(b.b)("li",{parentName:"ul"},"I ported over my personal site from ",Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"/blog/migrating-to-hugo"}),"Hugo")," to ",Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/leerob/leerob.io"}),"Next.js + MDX"),"."),Object(b.b)("li",{parentName:"ul"},"I created ",Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://dsmtech.io/"}),"dsmtech.io")," (and explored using ",Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"/blog/using-mapbox-with-next-js"}),"Mapbox"),")."),Object(b.b)("li",{parentName:"ul"},"A handful of projects at ",Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://innovate.hy-vee.com/"}),"Hy-Vee")," are being ",Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://stackshare.io/hy-vee/hy-vee-aisles-online"}),"rebuilt with Next.js"),".")),Object(b.b)("p",null,"Along that journey, I've grown to really \u2764 Next.js and it's ecosystem. Here are some of the things I've learned along the way."),Object(b.b)("h2",{id:"css-in-js"},"CSS-In-JS"),Object(b.b)("p",null,"I used to be strongly against CSS-in-JS. If you didn't like CSS, then use SASS/LESS. ",Object(b.b)("em",{parentName:"p"},"Why mix styling with your code"),"?"),Object(b.b)("p",null,"Well, turns out I was wrong. ",Object(b.b)("strong",{parentName:"p"},"Styling is code")," and I have never felt more productive styling components than I do using CSS-in-JS.\nNext.js comes preloaded with ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/zeit/styled-jsx"}),"styled-jsx"),", which is fine, but I prefer ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.styled-components.com/"}),"styled-components")," \ud83d\udc85"),Object(b.b)("p",null,"If you want learn more, check out ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/blog/ui-component-library-with-styled-components"}),"Building a UI Component Library with Styled Components"),"."),Object(b.b)("h2",{id:"font-loading"},"Font Loading"),Object(b.b)("p",null,"Performant font loading is much, much more difficult than I thought. I'm immensely grateful to Zach Leatherman for his\n",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.zachleat.com/web/comprehensive-webfonts"}),"Comprehensive Guide on Web Fonts."),"\nOne approach I've taken is to use ",Object(b.b)("inlineCode",{parentName:"p"},"@font-face")," in combination with the ",Object(b.b)("inlineCode",{parentName:"p"},"font-display")," ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/font-display"}),"attribute"),"."),Object(b.b)("p",null,"This approach allows me prevent FOUT (Flash of Unstyled Text) but still has FOIT (Flash of Invisible Text). Yes, FOIT is undeserable, but thanks to Next.js my ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://developers.google.com/web/tools/lighthouse/"}),"Lighthouse"),"\nperformance score is still almost 100."),Object(b.b)("pre",{className:"language-css"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-css"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token atrule"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token rule"}),"@font-face"))," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"font-family"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'Fira Sans'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"src"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token url"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token function"}),"url"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"("),"'/fonts/FiraSans-Bold.ttf'",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),")")),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"font-weight"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," bold",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"font-display"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," auto",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"font-style"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," normal",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(b.b)("p",null,"Another approach I've used with Google Fonts is to include the ",Object(b.b)("inlineCode",{parentName:"p"},"link")," in the ",Object(b.b)("inlineCode",{parentName:"p"},"Head")," of my document."),Object(b.b)("div",{className:"remark-code-title"},"pages/_document.js"),Object(b.b)("pre",{className:"language-js"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"import")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"Document"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"Head"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"Main"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"NextScript")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"from")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'next/document'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"import")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"React")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"from")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'react'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"class")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token class-name"}),"CustomDocument")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"extends")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token class-name"}),"Document")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"render"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"return")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"\n      ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"<"),"html lang",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"en"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),">"),"\n        ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"<"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"Head"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),">"),"\n          ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"<"),"link\n            href",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"https://fonts.googleapis.com/css?family=Fira+Sans:400,400i,700&display=swap"'),"\n            rel",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"stylesheet"'),"\n          ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"/"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),">"),"\n        ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"<"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"/"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"Head"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),">"),"\n        ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"<"),"body",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),">"),"\n          ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"<"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"Main")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"/"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),">"),"\n          ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"<"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"NextScript")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"/"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),">"),"\n        ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"<"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"/"),"body",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),">"),"\n      ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"<"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"/"),"html",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),">"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"export")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"default")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"CustomDocument"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n")),Object(b.b)("p",null,"Becoming informed about all the different options and their tradeoffs has been a worthy investment."),Object(b.b)("h2",{id:"dynamic-imports-and-testing"},"Dynamic Imports and Testing"),Object(b.b)("p",null,"It's likely that at some point in scaling your Next.js app, you'll want to use an external package\nthat doesn't work well server-side rendered. For me, this package was ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://react-select.com"}),"react-select"),"."),Object(b.b)("p",null,"When SSR this component, it simply did not work in Safari. Until that bug is fixed, I needed a workaround. Thanks\nto Next's ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://nextjs.org/docs/#dynamic-import"}),"Dynamic Imports"),", it's easy to import a component and disable SSR."),Object(b.b)("pre",{className:"language-jsx"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-jsx"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"import")," dynamic ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"from")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'next/dynamic'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"const")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"ReactSelectNoSSR")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"dynamic"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token arrow operator"}),"=>")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"import"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'../components/select'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ssr",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"false"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"export")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"default")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token arrow operator"}),"=>")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"<")),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),">")),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token plain-text"}),"\n    "),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"<"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token class-name"}),"Header"))," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"/>")),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token plain-text"}),"\n    "),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"<"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token class-name"}),"ReactSelectNoSSR"))," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"/>")),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token plain-text"}),"\n    "),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"<"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token class-name"}),"Footer"))," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"/>")),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token plain-text"}),"\n  "),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"</")),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),">")),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n")),Object(b.b)("p",null,"While this works, we can go a step further and provide a ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/blog/loading-placeholder-with-sass"}),"loading placeholder")," to make the user experience better."),Object(b.b)("pre",{className:"language-jsx"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-jsx"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"const")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"ReactSelectNoSSR")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"dynamic"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token arrow operator"}),"=>")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"import"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'../components/select'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function-variable function"}),"loading"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token arrow operator"}),"=>")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"<"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token class-name"}),"Input"))," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"/>")),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ssr",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"false"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n")),Object(b.b)("p",null,"Much better \ud83c\udf89 Now, how do we test it?"),Object(b.b)("p",null,"My preferred testing library is ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://jestjs.io/"}),"Jest"),". The dynamic import support offered by Next.js ",Object(b.b)("strong",{parentName:"p"},"does not")," expose a way to preload the dynamically imported components in Jest\u2019s environment.\nHowever, thanks to ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/FormidableLabs/jest-next-dynamic"}),"jest-next-dynamic"),", we can render the full component tree instead of the loading placeholder. Perfect!"),Object(b.b)("p",null,"You'll need to add ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.npmjs.com/package/babel-plugin-dynamic-import-node"}),"babel-plugin-dynamic-import-node")," to your ",Object(b.b)("inlineCode",{parentName:"p"},".babelrc")," like so."),Object(b.b)("div",{className:"remark-code-title"},".babelrc"),Object(b.b)("pre",{className:"language-js"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"plugins"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"babel-plugin-dynamic-import-node"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(b.b)("p",null,"Then, you can use ",Object(b.b)("inlineCode",{parentName:"p"},"preloadAll()")," to render the component instead of the loading placeholder."),Object(b.b)("pre",{className:"language-jsx"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-jsx"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"import")," preloadAll ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"from")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'jest-next-dynamic'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"import")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token maybe-class-name"}),"ReactSelect")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"from")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'./select'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"beforeAll"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"async")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token arrow operator"}),"=>")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"await")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"preloadAll"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n")),Object(b.b)("h2",{id:"mdx"},"MDX"),Object(b.b)("p",null,"My ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/leerob/leerob.io"}),"portfolio")," has transformed quite a bit since I started it in 2014. Originally, it was\njust static HTML & CSS. Then, I ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/blog/migrating-to-hugo"}),"switched over to Hugo")," so I could write my posts in Markdown.\nThis worked well for a while, but I wanted full control over my layouts and felt much more comfortable with JavaScript.\nThat's what led me to Next.js and MDX."),Object(b.b)("p",null,"With ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/mdx-js/mdx"}),"MDX"),", I can use JSX components inside my Markdown documents with ease. This way, if I want to do\nsomething custom, it's as simple as importing a React component. I've also started writing my presentations with MDX and ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/pomber/code-surfer"}),"code-surfer")," \ud83c\udfc4"),Object(b.b)("h2",{id:"link-prefetching"},"Link Prefetching"),Object(b.b)("p",null,"For maximum performance, you can use the ",Object(b.b)("inlineCode",{parentName:"p"},"prefetch")," ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://nextjs.org/docs#prefetching-pages"}),"attribute")," on Next's ",Object(b.b)("inlineCode",{parentName:"p"},"<Link>")," component. This will give the perception\nthe page loads instantly. As of ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://nextjs.org/blog/next-8/"}),"Next.js 8"),", ",Object(b.b)("inlineCode",{parentName:"p"},"prefetch")," uses ",Object(b.b)("inlineCode",{parentName:"p"},'<link rel="preload">')," instead of a ",Object(b.b)("inlineCode",{parentName:"p"},"<script>")," tag. It also only starts prefetching after ",Object(b.b)("inlineCode",{parentName:"p"},"onload")," to allow the browser to manage resources."),Object(b.b)("pre",{className:"language-jsx"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-jsx"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"<"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token class-name"}),"Link"))," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token attr-name"}),"prefetch")," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token attr-name"}),"href"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token attr-value"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"="),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),'"'),"/",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),'"')),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),">")),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token plain-text"}),"\n  "),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"<"),"a"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),">")),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token plain-text"}),"Home"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"</"),"a"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),">")),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token plain-text"}),"\n"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token tag"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"</"),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token class-name"}),"Link")),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),">")),"\n")),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"Update:")," Next.js 9 will ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://nextjs.org/blog/next-9#prefetching-in-viewport-links"}),"automatically prefetch")," ",Object(b.b)("inlineCode",{parentName:"p"},"<Link>")," components as they appear in-viewport. You no longer need to explicitly say ",Object(b.b)("inlineCode",{parentName:"p"},"prefetch"),"."),Object(b.b)("h2",{id:"polyfills"},"Polyfills"),Object(b.b)("p",null,"Next.js supports IE10 and all modern browsers out of the box using ",Object(b.b)("inlineCode",{parentName:"p"},"@babel/preset-env"),".\nHowever, it's possible that your own code or external NPM dependencies might use features not supported in your target browsers. In this case,\nyou will need to add polyfills. This requires changes in a couple of places."),Object(b.b)("p",null,"First, you will need to create/override your ",Object(b.b)("inlineCode",{parentName:"p"},"next.config.js")," file to customize Webpack."),Object(b.b)("div",{className:"remark-code-title"},"next.config.js"),Object(b.b)("pre",{className:"language-js"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"module",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"exports")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function-variable function"}),"webpack"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),":")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"function")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token parameter"}),"cfg"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"const")," originalEntry ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," cfg",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property-access"}),"entry"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n    cfg",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method-variable function-variable method function property-access"}),"entry")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"async")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token arrow operator"}),"=>")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"const")," entries ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"await")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"originalEntry"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n      ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"if")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"\n        entries",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'main.js'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"&&"),"\n        ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"!"),"entries",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'main.js'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"includes"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'./client/polyfills.js'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),"\n      ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        entries",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'main.js'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token method function property-access"}),"unshift"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'./client/polyfills.js'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n      ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n      ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"return")," entries",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"return")," cfg",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n")),Object(b.b)("p",null,"Then, create ",Object(b.b)("inlineCode",{parentName:"p"},"/client/polyfills.js")," and include whichever polyfills you need."),Object(b.b)("pre",{className:"language-js"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword module"}),"import")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'@babel/polyfill'"),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n")),Object(b.b)("h2",{id:"vercel"},"Vercel"),Object(b.b)("p",null,Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://vercel.com"}),"Vercel")," is hands down the ",Object(b.b)("strong",{parentName:"p"},"easiest way to deploy applications")," I've ever used.\nIt's incredibly easy to get started and their GitHub integration will automatically deploy your app on pull requests and leave a link\nfor you to review the changes. If everything looks good, it will deploy to prod when the PR is merged. Simple as that."),Object(b.b)("p",null,"The icing on the cake is how well the Vercel ecosystem works together. Their ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://vercel.com/domains"}),"domain service")," allows you\nto buy domains ",Object(b.b)("em",{parentName:"p"},"from the command line"),". I've never been able to go from an idea to a live, deployed application\nhosted on a domain so fast."),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"Bonus:")," I was even able to ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://spectrum.chat/zeit/now/redirection-email-domain~b5e1b613-ae92-42f9-bc49-e8c824a8a7f2?m=MTUzNDE5OTg3MzMwMw=="}),"setup email forwarding")," for my domain and create ",Object(b.b)("inlineCode",{parentName:"p"},"me@leerob.io")," using ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://improvmx.com/"}),"improvmx")," \ud83c\udf89"),Object(b.b)("h2",{id:"where-to-get-help"},"Where to Get Help"),Object(b.b)("p",null,"The Next.js and Vercel community support is ",Object(b.b)("em",{parentName:"p"},"fantastic"),". They're very responsive to emails, issues, or any other form\nof contact. My preferred method would be ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/zeit/next.js/discussions"}),"GitHub Discussions"),". Thanks to Discussions, all\nquestions and answers are indexed, searchable, and easy to find. Their ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://nextjs.org/learn/"}),"tutorials")," and ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"https://nextjs.org/docs"}),"docs")," are also fantastic and well-written."),Object(b.b)("h2",{id:"additional-resources"},"Additional Resources"),Object(b.b)("ul",null,Object(b.b)("li",{parentName:"ul"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://masteringnextjs.com/resources"}),"Next.js Resources")),Object(b.b)("li",{parentName:"ul"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://medium.com/zerostories/5-tips-for-building-a-next-js-app-576fd1f7c065"}),"5 Tips for Building a Next.js App")),Object(b.b)("li",{parentName:"ul"},Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"https://medium.com/styled-components/building-a-blog-with-next-js-359cf1236574"}),"Building a Blog With Next.js and styled-components"))))}l.isMDXComponent=!0}},[["GeLz",1,2,0,3,4,5,6,7,8]]]);